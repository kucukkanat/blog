(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{169:function(t,s,e){t.exports=e.p+"assets/img/idk-why.abf87af0.png"},170:function(t,s,e){t.exports=e.p+"assets/img/console-log-crypto.1eb1da90.png"},177:function(t,s,e){"use strict";e.r(s);var n=[function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"javascript-bundler-mysteries-can-we-do-that-on-browser"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript-bundler-mysteries-can-we-do-that-on-browser","aria-hidden":"true"}},[this._v("#")]),this._v(" Javascript bundler mysteries! Can we do that on browser ?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:e(169),width:"300"}})])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("create a keypair")]),t._v(" "),e("li",[t._v("take a message")]),t._v(" "),e("li",[t._v("hash it")]),t._v(" "),e("li",[t._v("sign the hash with the private key")]),t._v(" "),e("li",[t._v("verify the signature with public key")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" crypto "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"crypto"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EC")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'elliptic'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ec"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("hash")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" crypto"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createHash")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sha256'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("digest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hex"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create and initialize EC context")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (better do it once and reuse it)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ec "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EC")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'secp256k1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Generate keys")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" keys "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ec"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("genKeyPair")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" publicKey "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" keys"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPublic")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hex"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" privateKey "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" keys"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPrivate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hex"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("privateKey"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("publicKey"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sign")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" privateKey")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" ec"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("keyFromPrivate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("privateKey"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sign")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toDER")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("verify")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" signature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" publicKey")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" ec"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("keyFromPublic")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("publicKey"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hex"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("verify")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" signature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" signature "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sign")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" privateKey"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("signature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("verify")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("signature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" publicKey"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Now I try to run my code : "),s("code",[this._v("node index.js")]),this._v(" . IT WORKS!")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Afterwards, I wanted to be able to sign on the browser as well.\nSince "),s("code",[this._v("crypto")]),this._v(" is a core node module I wasn't expecting it first to work on browser.")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("Create an "),e("code",[t._v("index.html")])]),t._v(" "),e("li",[t._v("Call "),e("code",[t._v('<script src="./index.js">')]),t._v(" in "),e("code",[t._v("index.html")])]),t._v(" "),e("li",[t._v("Run "),e("code",[t._v("parcel index.html")])]),t._v(" "),e("li",[e("em",[t._v("Voilá!")]),t._v(" On the browser it works!")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("I wanted to know where "),s("code",[this._v("crypto")]),this._v(" module was required. So added a new line to my code on top:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("const crypto = require(\"crypto\")\nconsole.log(require.resolve('crypto'))\nconst EC = require('elliptic').ec;\n\n...\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("When I run "),s("code",[this._v("node index.js")]),this._v(" that "),s("code",[this._v("console.log")]),this._v(" prints the String "),s("code",[this._v("crypto")]),this._v(" only. But on the browser console there was something uncanny!")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:e(170),width:"300"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Did you see that "),s("code",[this._v("../../.config/yarn/global/node_modules/crypto-browserify/index.js")]),this._v(" too ?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("I couldn't find any explanation about this "),s("em",[this._v("feature")]),this._v(" in any of their documentation. Even though it bugs me to find out there is some magic happening behind the curtains, sometimes it is nice to have those kind of out of the box features. This feature did not only saved me time, but also added fun to this evening!")])}],a=e(0),r=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),e("p",[t._v("So, I was working on some experimental crypto stuff today when I literally became the guy on the famous meme myself.")]),t._v(" "),t._m(1),t._v(" "),e("p",[t._v("The idea is to create a simple digital signature using "),e("code",[t._v("secp256k1")]),t._v(". For more info check "),e("a",{attrs:{href:"https://en.bitcoin.it/wiki/Secp256k1",target:"_blank",rel:"noopener noreferrer"}},[t._v("secp256k1"),e("OutboundLink")],1),t._v(" , "),e("a",{attrs:{href:"https://en.bitcoin.it/wiki/Elliptic_Curve_Digital_Signature_Algorithm",target:"_blank",rel:"noopener noreferrer"}},[t._v("Elliptic Curve Digital Signature Algorithm"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("I was trying a simple gist that will :")]),t._v(" "),t._m(2),t._v(" "),e("p",[t._v("Example code is here :")]),t._v(" "),t._m(3),t._m(4),t._v(" "),t._m(5),t._v(" "),e("p",[t._v("My first attempt was to use "),e("a",{attrs:{href:"https://parceljs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("parcel-bundler"),e("OutboundLink")],1),t._v(" .")]),t._v(" "),t._m(6),t._v(" "),e("p",[t._v('But then I was like "Why does it work ?"')]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),e("p",[t._v("I packed up my backpack, kissed me darling mother and went on an adventure of stalking code, sniffing the github repos. Even though I thought it was going to be a needle in the haystack I came across some resources which actually revealed the mystery.")]),t._v(" "),e("p",[t._v("Turns out "),e("a",{attrs:{href:"https://github.com/browserify/browserify/blob/ae01d90900b21719e9fef7bedfc4db55ea22b71a/lib/builtins.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("browserify"),e("OutboundLink")],1),t._v(" has a "),e("code",[t._v("builtins.js")]),t._v(" that maps some of the nodejs core modules to their browser equivalents and in build-time, requires them.")]),t._v(" "),e("p",[t._v("I found out "),e("a",{attrs:{href:"https://github.com/parcel-bundler/parcel/blob/master/packages/core/parcel-bundler/src/builtins/index.js#L1",target:"_blank",rel:"noopener noreferrer"}},[t._v("parcel"),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://github.com/webpack/webpack/blob/573d2da1d946b59ef6990cea0edf31958d13c0d6/lib/node/NodeSourcePlugin.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack"),e("OutboundLink")],1),t._v(" use a webpack-core library called "),e("code",[t._v("node-libs-browser")]),t._v(" to replace those modules with their browser equivalents.")]),t._v(" "),t._m(12),t._v(" "),e("p",[t._v("Peace!")])])},n,!1,null,null,null);s.default=r.exports}}]);